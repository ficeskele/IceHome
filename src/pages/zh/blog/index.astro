---
import PageLayout from "@/layouts/PageLayout.astro";
import PostCard from "@/components/PostCard.astro";
import { getCollection } from "astro:content";
import { useTranslation } from "@/i18n/utils";

const locale = "zh";
const t = useTranslation(locale);

const posts = (
  await getCollection("blog", (entry) =>
    entry.data.locale === locale && !entry.data.draft
  )
).sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<PageLayout title={t("blog.title")} description={t("blog.description")} locale={locale}>
  <div class="space-y-8">
    <div>
      <h1 class="text-4xl font-bold tracking-tight">{t("blog.title")}</h1>
      <p class="mt-2 text-lg text-muted-foreground">{t("blog.description")}</p>
    </div>
    {posts.length === 0 ? (
      <p class="text-muted-foreground">{t("blog.noPosts")}</p>
    ) : (
      <div class="grid gap-6">
        {posts.map((post) => (
          <PostCard
            title={post.data.title}
            description={post.data.description}
            date={post.data.date}
            tags={post.data.tags}
            href={`/${locale}/blog/${post.id}`}
            locale={locale}
          />
        ))}
      </div>
    )}
  </div>
</PageLayout>
