---
import BaseLayout from "./BaseLayout.astro";
import Navigation from "@/components/Navigation.astro";
import Footer from "@/components/Footer.astro";
import Container from "@/components/Container.astro";
import Badge from "@/components/Badge.astro";
import Button from "@/components/Button.astro";
import type { Locale } from "@/i18n/locales";
import { formatDate, useTranslation } from "@/i18n/utils";
import { getReadingTime } from "@/lib/utils";

interface Props {
  title: string;
  description: string;
  date: Date;
  tags: string[];
  locale: Locale;
  image?: string;
  body: string;
}

const { title, description, date, tags, locale, image, body } = Astro.props;
const t = useTranslation(locale);
const readingTime = getReadingTime(body);
---

<BaseLayout title={title} description={description} locale={locale} image={image}>
  <Navigation />
  <main class="py-10">
    <Container class="max-w-3xl">
      <div class="mb-4">
        <Button variant="ghost" size="sm" href={`/${locale}/blog`}>
          &larr; {t("blog.backToBlog")}
        </Button>
      </div>
      <article>
        <header class="mb-8 space-y-4">
          <h1 class="text-4xl font-bold tracking-tight">{title}</h1>
          <div class="flex flex-wrap items-center gap-4 text-sm text-muted-foreground">
            <time datetime={date.toISOString()}>{formatDate(date, locale)}</time>
            <span>&middot;</span>
            <span>{readingTime} {t("blog.readingTime")}</span>
          </div>
          {tags.length > 0 && (
            <div class="flex flex-wrap gap-2">
              {tags.map((tag) => (
                <Badge>{tag}</Badge>
              ))}
            </div>
          )}
        </header>
        <div class="prose dark:prose-invert max-w-none">
          <slot />
        </div>
      </article>
    </Container>
  </main>
  <Footer />
</BaseLayout>
